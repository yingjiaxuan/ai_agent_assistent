# 信息参考与开发约定

## 1. 项目目标
- 构建面向在日留学生/务工人员的AI Agent生活助手，具备提醒、智能问答+记忆体、本地服务推荐三大功能。
- 智能部分主要通过prompt调用大模型（如GPT-4o、Claude、DeepSeek等）。

## 2. 数据结构与mock数据
- **data/** 目录下有 `reminders.db`（SQLite数据库），包含三张表：
  - `users`：用户画像（冷数据）
  - `conversations`：对话历史（热数据）
  - `memory_summaries`：记忆摘要（热数据）
- **memory/** 目录下有 `user_memory.yaml`，结构如下：
  - `users` 列表，每个用户包含 `user_profile`（冷数据）和 `memory_summaries`（热数据摘要）。
  - mock数据已包含张三和李四，与数据库内容一致。

## 3. 冷热数据交互与设计细节
- **冷数据**：用户基本信息（如姓名、年龄、性别、学历、职业、兴趣、语言、注册/活跃时间等），变化频率低，主要用于用户画像。
- **热数据**：用户与AI的对话历史、行为记录，定期（如每周）用prompt让大模型总结，形成"记忆摘要"。
- **记忆体管理流程**：
  1. 对话历史（热数据）存入数据库（conversations表）。
  2. 定期/手动回顾热数据，prompt大模型生成记忆摘要，写入memory_summaries表和yaml。
  3. 用户可手动编辑摘要，并可选择让大模型润色。
  4. 新对话时，将冷数据（用户画像）和热数据摘要作为prompt上下文，提升个性化体验。
- **存储方式**：
  - 采用memory目录下的yaml文件，结构化存储冷/热数据。
  - 也可结合sqlite存储大体量对话历史，yaml存储高频访问的画像和摘要。

## 4. 开发进度与约定
- 项目目录结构搭建完毕。
- mock数据和数据库表结构设计与初始化已完成。
- mock数据已保持数据库和yaml文件一致。
- 冷热数据目前分层存储，结构暂不调整，后续如需变更可再讨论。
- 下一步准备进入Agent核心功能开发（如命令行交互、记忆体生成/修订/润色等）。

## 5. 交互与开发约定
- 如需在新对话中承接上下文，可直接引用本md文件。
- 如需补充其它细节或mock数据，随时在新对话中说明。

## 6. 参考文档
- 详细需求、功能规划、技术栈等见 `AI_Agent_Life_Assistant_DEMO1.0.md`。 

## 7. 从这一段对话开始继续讨论
- 首先我觉得我们得统一认知，即我此次的规划是完成一个ai agent，大部分智能功能可采用promt的方式调用大模型完成（主要调用对象可能是openai的gpt4o，claude，deepseek（目标中文内容）等）
首先我觉得我需要讨论在我的规划中，用户个人数据如何存储，我原先与chatgpt讨论的结果是在memory目录下存一个yaml文件。并且区分冷热数据，冷数据可能有用户基本信息，年龄，性别等（这方面也需要你帮我完善），热数据主要就是存储记忆，即根据之前的计划——基于一定的周期回顾用户的对话（可能是一周），利用prompt询问大模型做出一些总结（此处需要利用一些prompt engineering的通用方法，这方面也需要你的辅助），然后进行存储，当存储达到一定范围后，再度调用prompt做二次总结。并且总结出来的内容可以由用户手动修改，用户手动修改后，可选择是否让大模型精修。当用户开启一个新对话时，则将存储的用户画像作为第一条prompt和用户最开始的问题一起输入，从而实现用户画像的功能。这部分的总结的主要目的是为了用户持续拥有个人数据。
故而这部分的实现应该是重中之重，请先与我讨论这一功能的可行性，然后我们生成数据库后，首先就实现这一核心功能，我希望能先通过命令行快速体验功能，然后我们再进入UI开发阶段。